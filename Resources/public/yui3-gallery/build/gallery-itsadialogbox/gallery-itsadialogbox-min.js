YUI.add("gallery-itsadialogbox",function(g){var e=g.Lang,d="<div class='itsadialogbox-icon {iconclass}'></div>",a="<div{bdclass}>{bdtext}</div>",c="itsa-dialog-inlineform";g.ITSADIALOGBOX=g.Base.create("itsadialogbox",g.Panel,[],{ICON_BUBBLE:"icon-bubble",ICON_INFO:"icon-info",ICON_QUESTION:"icon-question",ICON_WARN:"icon-warn",ICON_ERROR:"icon-error",ICON_SUCCESS:"icon-success",ACTION_HIDE:"_actionHide",ACTION_STAYALIVE:"_actionStayAlive",ACTION_RESET:"_actionReset",ACTION_CLEAR:"_actionClear",panelOptions:[],_activePanelOption:null,_validationButtons:null,_descendantChange:0,initializer:function(){var h=this;h.get("contentBox").plug(g.Plugin.NodeFocusManager,{descendants:"button, input, textarea",circular:true,focusClass:"focus"});h._initiatePanels();},definePanel:function(i){var h=this;if(e.isObject(i)){h.panelOptions.push(i);return h.panelOptions.length-1;}else{return -1;}},showPanel:function(k,p,s,r,j,n,l,i,h){var q=this,o,m=q.get("contentBox");if((k>=0)&&(k<q.panelOptions.length)){q._activePanelOption=q.panelOptions[k];o=i||q._activePanelOption.iconClass;q.get("boundingBox").toggleClass("withicon",e.isString(o));if(!e.isString(s)){n=j;j=r;r=s;s=p;p="&nbsp;";}q.set("headerContent",p||"&nbsp;");q.set("bodyContent",(o?e.sub(d,{iconclass:o}):"")+e.sub(a,{bdclass:(o?' class="itsadialogbox-messageindent"':""),bdtext:s}));q.set("buttons",l||q._activePanelOption.buttons||{});q._activePanelOption.callback=r;q._activePanelOption.context=j;q._activePanelOption.args=n;q._activePanelOption.eventArgs=h;m.focusManager.refresh();q.centered();q.activatePanel();m.focusManager.focus(q._getFirstFocusNode());q.show();}},getRetryConfirmation:function(k,h,l,j,i){this.showPanel(0,k,h,l,j,i);},getConfirmation:function(k,h,l,j,i){this.showPanel(1,k,h,l,j,i);},getInput:function(n,r,l,q,i,m,k,h){var o=this,j,p;o.inputElement=new g.ITSAFORMELEMENT({name:"value",type:"input",value:l,classNameValue:"yui3-itsadialogbox-stringinput itsa-formelement-lastelement",marginTop:10,initialFocus:true,selectOnFocus:true});o.showPanel(2,n,r+"<br>"+o.inputElement.render(),q,i,m,k,h);},getNumber:function(o,w,u,x,p,t,i,m,l,h){var r=this,j,v=e.isNumber(x),n=e.isNumber(p),s,q="",k={};if(v&&n){q="Input must be between "+x+" and "+p;}else{if(v){q="Input must not be below "+x;}if(n){q="Input must not be above "+p;}}r.inputElement=new g.ITSAFORMELEMENT({name:"value",type:"input",value:u?u.toString():"",label:w,keyValidation:function(E){var F=E.keyCode,A=E.target,B=true,J=A.get("selectionStart"),L=A.get("selectionEnd"),G=A.get("value"),K=String.fromCharCode(((F>=96)&&(F<=105))?F-48:F),H,I=E.minValue,D=E.maxValue,z=[48,49,50,51,52,53,54,55,56,57,96,97,98,99,100,101,102,103,104,105],y=[8,9,13,27,37,38,39,40,46,48,49,50,51,52,53,54,55,56,57,173,189,45,96,97,98,99,100,101,102,103,104,105,109],C=[173,189,45,109];if(g.Array.indexOf(y,F)===-1){E.halt(true);return false;}if(((E.shiftKey)&&(F!==9)&&(F!==37)&&(F!==38)&&(F!==39)&&(F!==40))||(E.ctrlKey)||(E.altKey)||(E.metaKey)){E.halt(true);return false;}if(e.isNumber(I)&&(I>0)&&(J===0)&&((F===48)||(F===96))){E.halt(true);return false;}if((J===1)&&((F===48)||(F===96))&&((G==="0")||(G==="-"))){E.halt(true);return false;}if(e.isNumber(I)&&(I>=0)&&(J===0)&&(g.Array.indexOf(C,F)!==-1)){E.halt(true);return false;}if((J>0)&&(g.Array.indexOf(C,F)!==-1)){E.halt(true);return false;}if((e.isNumber(I)||e.isNumber(D))&&((g.Array.indexOf(z,F)!==-1)||(F===8)||(F===46))){if(F===8){H=parseInt(G.substring(0,(J===L)?J-1:J)+G.substring(L),10);}else{if(F===46){H=parseInt(G.substring(0,J)+G.substring((J===L)?L+1:L),10);}else{H=parseInt(G.substring(0,J)+K+G.substring(L),10);}}if(!e.isNumber(H)){if(E.showValidation){E.showValidation();}if(E.deactivatePanel){E.deactivatePanel();}B=false;}else{if(e.isNumber(I)&&(H<I)){if(E.showValidation){E.showValidation();}if(E.deactivatePanel){E.deactivatePanel();}B=false;}else{if(e.isNumber(D)&&(H>D)){if(E.showValidation){E.showValidation();}if(E.deactivatePanel){E.deactivatePanel();}B=false;}}}}if((J===1)&&(G==="0")&&(g.Array.indexOf(z,F)!==-1)){A.set("value","");}if(B&&E.hideValidation){E.hideValidation();}if(B&&E.activatePanel){E.activatePanel();}return true;},autoCorrection:function(E){var C=this,z=E&&E.minValue,A=E&&E.maxValue,y=C.get("elementNode").get("value"),B=((y==="")||(y==="-"))?0:y,D=parseInt(B,10);C.set("value",D.toString());if((e.isNumber(z)&&(D<z))||(e.isNumber(A)&&(D>A))){if(E.showValidation){E.showValidation();}if(E.activatePanel){E.activatePanel();}return false;}return true;},validationMessage:q,classNameValue:"yui3-itsadialogbox-numberinput itsa-formelement-lastelement",initialFocus:true,selectOnFocus:true});if(e.isNumber(x)){k.minValue=x;}if(e.isNumber(p)){k.maxValue=p;}if(q){k.showValidation=g.bind(r.inputElement.showValidation,r.inputElement);k.hideValidation=g.bind(r.inputElement.hideValidation,r.inputElement);}if(k.minValue||k.maxValue){k.activatePanel=g.bind(r.activatePanel,r);k.deactivatePanel=g.bind(r.deactivatePanel,r);}r.showPanel(3,o,r.inputElement.render(),t,i,m,l,h,k);},showErrorMessage:function(k,j,l,i,h){this.showPanel(4,k,j,l,i,h);},showMessage:function(m,l,n,j,h,i,k){this.showPanel(5,m,l,n,j,h,i,k);},showWarning:function(k,j,l,i,h){this.showPanel(6,k,j,l,i,h);},_actionHide:function(l){var h=this,k=h.get("contentBox").one(".yui3-widget-bd"),j=h._serializeForm(k),i=l.target;l.preventDefault();if(!i.hasClass("yui3-button-disabled")){j.buttonName=l.target.getData("name");h.hide();if(g.Lang.isFunction(h._activePanelOption.callback)){g.rbind(h._activePanelOption.callback,h._activePanelOption.context,j,h._activePanelOption.args)();}}},_actionStayAlive:function(l){var h=this,k=h.get("contentBox").one(".yui3-widget-bd"),j=h._serializeForm(k),i=l.target;l.preventDefault();if(!i.hasClass("yui3-button-disabled")){j.buttonName=l.target.getData("name");if(g.Lang.isFunction(h._activePanelOption.callback)){g.rbind(h._activePanelOption.callback,h._activePanelOption.context,j,h._activePanelOption.args)();}}},_actionReset:function(k){var h=this,j=h.get("contentBox").one(".yui3-widget-bd"),i=h._serializeForm(j);
k.preventDefault();i.buttonName=k.target.getData("name");},_actionClear:function(k){var h=this,j=h.get("contentBox").one(".yui3-widget-bd"),i=h._serializeForm(j);k.preventDefault();i.buttonName=k.target.getData("name");},focus:function(){var h=this,j=h.get("contentBox"),i=j.focusManager;h.constructor.superclass.focus.apply(h,arguments);if(i){i.focus();}},bindUI:function(){var h=this,j=h.get("contentBox"),i=j.focusManager;h._panelListener=j.on("keydown",function(k){if(k.keyCode===9){k.preventDefault();this.shiftFocus(k.shiftKey);}},h);h._buttonsListener=h.after("buttonsChange",h._setValidationButtons,h);h._descendantListener=j.focusManager.on("activeDescendantChange",function(r,o){var k=this,q=r.prevVal,n=r.newVal,m,l,p=o.focusManager.get("descendants");k._descendantChange++;if(e.isNumber(q)&&(q>=0)){q=p.item(r.prevVal);}if(e.isNumber(n)){n=p.item(r.newVal);}m=o.one(".yui3-button-primary");l=(n.get("tagName")==="BUTTON");if(m){m.toggleClass("nofocus",((n!==m)&&l));}p.removeClass("mousepressfocus");if(l){n.addClass("mousepressfocus");}if((!n.compareTo(q)||(k._descendantChange<4))&&n.hasClass("itsa-formelement-selectall")){n.select();}},h,j);h._headerMousedownListener=j.delegate("mousedown",function(k){k.target.addClass("cursormove");},".yui3-widget-hd");h._headerMouseupListener=j.delegate("mouseup",function(k){k.target.removeClass("cursormove");},".yui3-widget-hd");h._inputListener=j.delegate("keydown",h._checkInput,"input",h);h._blurInputListener=j.delegate("blur",h._checkInputBlur,"input",h);h._checkBoxListener=j.delegate("change",h._shiftFocusFromCheckbox,function(){var k=this;return((k.get("tagName")==="INPUT")&&(k.get("type")==="checkbox"));},h);j.on("click",function(){this.focus(this.get("activeDescendant"));},i);},shiftFocus:function(n,j){var h=this,i=h.get("contentBox").focusManager,k=i.get("descendants"),l=j?k.indexOf(j):i.get("activeDescendant"),m=k.size();if(j||i.get("focused")){if(e.isBoolean(n)&&n){l--;i.focus((l<0)?m-1:l);}else{l++;i.focus((l>=m)?0:l);}}else{i.focus(h._getFirstFocusNode());}},_shiftFocusFromCheckbox:function(j){var h=this,i=j.target;if(i.hasClass("itsa-formelement-lastelement")){h.get("contentBox").focusManager.focus(h._getDefaultButtonNode());}else{h.shiftFocus(false,i);}},_checkInput:function(m){var h=this,k=m.target,i,l,j=h._activePanelOption.eventArgs;if(k.hasClass("itsa-formelement-keyvalidation")&&h.inputElement){g.mix(m,j);if(!h.inputElement.get("keyValidation")(m)){return;}}if(m.keyCode===13){m.preventDefault();if(k.hasClass("itsa-formelement-lastelement")){i=h.inputElement&&h.inputElement.get("autoCorrection");l=true;if(i){l=g.bind(i,h.inputElement,j.minValue,j.maxValue)();if(!l){j.showValidation();h.deactivatePanel();h.get("contentBox").focusManager.focus(h._getFirstFocusNode());}}if(l){k.setData("name",h._getDefaultButtonNode().getData("name"));h._actionHide(m);}else{k.select();}}else{h.shiftFocus();}}},_checkInputBlur:function(){var h=this,j=h._activePanelOption.eventArgs,i=h.inputElement&&h.inputElement.get("autoCorrection"),k=true;if(i){k=g.bind(i,h.inputElement,j)();if(!k){if(j&&j.showValidation){j.showValidation();}h.deactivatePanel();h.get("contentBox").focusManager.focus(h._getFirstFocusNode());}}if(k){if(j&&j.hideValidation){j.hideValidation();}h.activatePanel();}},activatePanel:function(){this._validationButtons.toggleClass("yui3-button-disabled",false);},deactivatePanel:function(){this._validationButtons.toggleClass("yui3-button-disabled",true);},destructor:function(){var h=this;if(h.keyDownHandle){h.keyDownHandle.detach();}if(h._panelListener){h._panelListener.detach();}if(h._descendantListener){h._descendantListener.detach();}if(h._headerMousedownListener){h._headerMousedownListener.detach();}if(h._headerMouseupListener){h._headerMouseupListener.detach();}if(h._inputListener){h._inputListener.detach();}if(h._blurInputListener){h._blurInputListener.detach();}if(h._checkBoxListener){h._checkBoxListener.detach();}if(h._buttonsListener){h._buttonsListener.detach();}},_setValidationButtons:function(k){var h=this,j=h._activePanelOption.buttons,i=h.get("contentBox");i.all(".itsadialogbox-button-validated").removeClass("itsadialogbox-button-validated");if(j){if(j.header){g.Array.each(j.header,h._markButtonValidated,h);}if(j.body){g.Array.each(j.body,h._markButtonValidated,h);}if(j.footer){g.Array.each(j.footer,h._markButtonValidated,h);}}h._validationButtons=i.all(".itsadialogbox-button-validated");},_markButtonValidated:function(i,m,n){var h=this,l=i.name,j,k;k=h.getButton(l);if(k){j=i.validation;if(e.isBoolean(j)&&j){k.addClass("itsadialogbox-button-validated");}}},_initiatePanels:function(){var h=this;h.definePanel({iconClass:h.ICON_WARN,buttons:{footer:[{name:"abort",label:"Abort",action:h.ACTION_HIDE},{name:"ignore",label:"Ignore",action:h.ACTION_HIDE},{name:"retry",label:"Retry",action:h.ACTION_HIDE,isDefault:true}]}});h.definePanel({iconClass:h.ICON_INFO,buttons:{footer:[{name:"no",label:"No",action:h.ACTION_HIDE},{name:"yes",label:"Yes",action:h.ACTION_HIDE,isDefault:true}]}});h.definePanel({iconClass:h.ICON_QUESTION,form:[{name:"count",label:"{message}",value:"{count}"}],buttons:{footer:[{name:"cancel",label:"Cancel",action:h.ACTION_HIDE},{name:"ok",label:"Ok",action:h.ACTION_HIDE,validation:true,isDefault:true}]}});h.definePanel({iconClass:h.ICON_QUESTION,form:[{name:"count",label:"{message}",value:"{count}"}],buttons:{footer:[{name:"cancel",label:"Cancel",action:h.ACTION_HIDE},{name:"ok",label:"Ok",action:h.ACTION_HIDE,validation:true,isDefault:true}]}});h.definePanel({iconClass:h.ICON_ERROR,buttons:{footer:[{name:"ok",label:"Ok",action:h.ACTION_HIDE,isDefault:true}]}});h.definePanel({buttons:{footer:[{name:"ok",label:"Ok",action:h.ACTION_HIDE,isDefault:true}]}});h.definePanel({iconClass:h.ICON_WARN,buttons:{footer:[{name:"ok",label:"Ok",action:h.ACTION_HIDE,isDefault:true}]}});},_getFirstFocusNode:function(){var h=this,j=h.get("contentBox"),i;i=j.one(".itsa-formelement-firstfocus")||j.one(".itsa-firstformelement")||h._getDefaultButtonNode();
return i;},_getDefaultButtonNode:function(){var h=this.get("contentBox").one(".yui3-button-primary");return h;},_serializeForm:function(k){var h=this,j=k.all(".itsa-formelement"),i={};j.each(function(n,m,l){i[n.get("name")]=n.get("value");});return i;}},{ATTRS:{}});if(!g.Global.ItsaDialog){g.Global.ItsaDialog=new g.ITSADIALOGBOX({visible:false,centered:true,render:true,zIndex:21000,modal:true,bodyContent:"",focusOn:[{eventName:"clickoutside"}]});g.Global.ItsaDialog.plug(g.Plugin.Drag);g.Global.ItsaDialog.dd.addHandle(".yui3-widget-hd");}var b='<td class="itsaform-tablelabel{classnamelabel}"{marginstyle}>{label}</td>'+'<td class="itsaform-tableelement">{element}<div class="itsa-formelement-validationmessage itsa-formelement-hidden">{validationMessage}</div></td>',f='<span class="itsaform-spanlabel{classnamelabel}"{marginstyle}>{label}</span>'+'{element}<div class="itsa-formelement-validationmessage itsa-formelement-hidden">{validationMessage}</div>';g.ITSAFORMELEMENT=g.Base.create("itsaformelement",g.Base,[],{id:null,initializer:function(){this.id=g.guid();},render:function(h){var z=this,m=z.get("marginTop"),k=m?' style="margin-top:'+m+'px"':"",o=z.get("type"),u=z.get("classNameLabel"),y=z.get("classNameValue"),p=z.get("initialFocus"),v=z.get("selectOnFocus"),x=z.get("keyValidation"),t=z.get("validation"),q=z.get("autoCorrection"),n=p?" itsa-formelement-firstfocus":"",s=v?" itsa-formelement-selectall":"",l=x?" itsa-formelement-keyvalidation":"",j=t?" itsa-formelement-validation":"",r=q?" itsa-formelement-autocorrect":"",w=' class="itsa-formelement '+y+n+s+l+j+r+'"',i="";if(o==="input"){i='<input id="'+z.id+'" type="text" name="'+z.get("name")+'" value="'+z.get("value")+'"'+w+k+" />";}return e.sub(h?b:f,{marginstyle:k,label:z.get("label"),element:i,classnamelabel:u,validationMessage:z.get("validationMessage"),classnamevalue:y});},showValidation:function(){var h=this.get("elementNode");if(h){h.get("parentNode").one(".itsa-formelement-validationmessage").toggleClass("itsa-formelement-hidden",false);}},hideValidation:function(){var h=this.get("elementNode");if(h){h.get("parentNode").one(".itsa-formelement-validationmessage").toggleClass("itsa-formelement-hidden",true);}},destructor:function(){var h=this;if(h.blurevent){h.blurevent.detach();}if(h.keyevent){h.keyevent.detach();}}},{ATTRS:{name:{value:"undefined-name",setter:function(i){var h=this.get("elementNode");if(h){h.set("name",i);}return i;},validator:function(h){return(e.isString(h));}},type:{value:"",setter:function(h){if(e.isString(h)){h=h.toLowerCase();}return h;},validator:function(h){return(e.isString(h)&&((h==="input")||(h==="password")||(h==="textarea")||(h==="checkbox")||(h==="radiogroup")||(h==="selectbox")||(h==="button")||(h==="hidden")));}},value:{value:null,setter:function(i){var h=this.get("elementNode");if(h){h.set("value",i);}return i;}},label:{value:"",validator:function(h){return(e.isString(h));}},keyValidation:{value:null,validator:function(h){return(e.isFunction(h));}},validation:{value:null,validator:function(h){return(e.isFunction(h));}},validationMessage:{value:"",validator:function(h){return(e.isString(h));}},autoCorrection:{value:null,validator:function(h){return(e.isFunction(h));}},classNameLabel:{value:"",validator:function(h){return(e.isString(h));}},classNameValue:{value:"",validator:function(h){return(e.isString(h));}},marginTop:{value:0,validator:function(h){return(e.isNumber(h));}},initialFocus:{value:false,validator:function(h){return(e.isBoolean(h));}},selectOnFocus:{value:false,validator:function(h){return(e.isBoolean(h));}},elementNode:{value:null,readOnly:true,getter:function(){return g.one("#"+this.id);}}}});},"gallery-2012.10.31-20-00",{requires:["base-build","widget-base","node-base","cssbutton","event-base","node-event-delegate","event-outside"],skinnable:true});